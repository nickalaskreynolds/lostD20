function diceRollerama(){function a(a){return document.querySelector(a)}function b(a){return document.querySelectorAll(a)}function c(a,b){a.classList.toggle(b)}function d(a,b){a.classList.add(b)}function e(a,b){a.classList.remove(b)}function f(a,b){window.setTimeout(a,b)}function g(a,b){for(var c=a[b],d=0;d<c.length;d++)c[d].checked&&(G=c[d].value);return G}function h(a,b){for(var c=a[b],d=0;d<c.length;d++)if(c[d].checked){L[d].classList.add("active");var e=parseInt(L[d].querySelector("input").value,10);O.textContent=e}else L[d].classList.remove("active")}function i(){for(var a=0;a<L.length;a++)L[a].addEventListener("click",function(){h(K,"dice-select")},!1)}function j(){var a=event.keyCode||event.which;13==a&&this.blur()}function k(a){var b=event.keyCode||event.which;38==b?r(1,a):40==b&&r(-1,a)}function l(a){a.setAttribute("value",a.value);var b=ga(a,".saved-formula");b.dataset.rollName=a.value}function m(){P.innerHTML="",C(),e(J,"active"),e(J,"fullsize")}function n(){return I=parseInt(X.value,10)||0,X.value<=0||""==X.value?X.value="":X.value>=999&&(X.value="999"),I}function o(){I=parseInt(X.value,10)||0,0==I&&(X.value="1")}function p(){return H=parseInt(T.value,10)||0,H>=999&&(T.value="999"),H}function q(){H=parseInt(T.value,10)||0,0==H&&(T.value="+0"),H>0&&(T.value="+"+H)}function r(a,b){b.value=1*b.value+a,0==a&&(b.value="0")}function s(a,b,c,d){for(var e=[],f=0;a>f;f++)e.push(Math.floor(Math.random()*b)+1);var g,h=function(a){g=0;for(var b=0;b<a.length;b++)a[b]<a[g]&&(g=b);return g};h(e);var i,j=e.reduce(function(a,b){return a+b}),k=aa.dataset.active;"true"==k&&a>1?(i=e[g],e[g]='<span class="strike">'+e[g]+"</span>"):i=0;var l,m=j+c-i,n=e.join(", ");l=c>0?"+":"";var o;o=0==c?"":l+c+" Bonus";var p;p=d?d+" = ":"";var q;q=20==b&&1==a?20==j?" critical-20":1==j?" critical-1":"":"",P.innerHTML='<div class="result-item"><div class="row"><div class="col-xs-8"><p class="breakdown"> <span class="save-roll-name">'+p+'</span> <span class="number-of-dice">'+a+'</span> <span class="dice">D'+b+'</span> <span class="multiple-dice-results">(Rolled: '+n+')</span> <span class="number-of-bonus">'+o+'</span></p></div><div class="col-xs-4"><p class="total'+q+'">'+m+"</p></div></div></div>"+P.innerHTML,C()}function t(a,b,c,d){var e=["Aieee!","Aiieee!","Arrgh!","Awk!","Awkkkkkk!","Bam!","Bang!","Bang!","Biff!","Bloop!","Blurp!","Boff!","Bonk!","Clank!","Clank!","Clash!","Clunk!","Clunk!","Crraack!","Crash!","Crraack!","Crunch!","Crunch!","Eee-yow!","Flrbbbbb!","Glipp!","Glurpp!","Kapow!","Kayo!","Ker-sploosh!","Kerplop!","Klonk!","Klunk!","Krunch!","Oooff!","Ooooff!","Ouch!","Ouch!","Owww!","Ow","Pam!","Plop!","Pow!","Powie!","Qunckkk!","Rakkk!","Rip!","Slosh!","Sock!","Splats!","Splatt!","Sploosh!","Swaap!","Swish!","Swoosh!","Thunk!","Thwack!","Thwacke!","Thwape!","Thwapp!","Uggh!","Urkkk!","Vronk!","Whack!","Whack!","Wham!","Whamm!","Whammm!","Whap!","Z-zwap!","Zam!","Zamm!","Zammm!","Zap!","Zap","Zgruppp!","Zlonk!","Zlopp!","Zlott!","Zok!","Zowie!","Zwapp!","Zzwap!","Zzzzwap!","Zzzzzwap!","Pepper-Pow!"],f=function(){f=d?d:e[Math.floor(Math.random()*e.length)]},g=function(){g=H>0?"+"+H:0>H?H:""},h=function(){h=1==I?" hidden":""},i=function(){g(),h(),f(),N.innerHTML='<div class="saved-formula" data-roll-name="'+f+'" data-ammount-of-dice="'+I+'" data-dice="'+G+'" data-ammount-of-bonus="'+H+'"><div class="row no-gutter"><div class="col-xs-12"><input type="text" placeholder="Who am I?" value="'+f+'" class="name" tabindex="4"></div><div class="col-xs-4"><p class="formula"><span class="number-of-dice'+h+'">'+I+'</span> <span class="dice">d'+G+'</span> <span class="number-of-bonus">'+g+'</span></p></div><div class="col-xs-2"><a href="javascript:void(0)" class="button button-secondary button-block clear" tabindex="4"><span class="icon-close"></span></a></div><div class="col-xs-2"><a href="javascript:void(0)" class="button button-secondary button-block move-up" tabindex="4"><span class="icon-expand-less"></span></a></div><div class="col-xs-2"><a href="javascript:void(0)" class="button button-secondary button-block move-down" tabindex="4"><span class="icon-expand-more"></span></a></div><div class="col-xs-2"><a href="javascript:void(0)" class="button button-primary button-block roll" tabindex="4"><span class="icon-chevron-right"></span></a></div></div></div>'+N.innerHTML};i(),u()}function u(){for(var a=b(".saved-formula"),c=b(".saved-formula .roll"),d=b(".saved-formula .move-up"),e=b(".saved-formula .move-down"),f=b(".saved-formula .clear"),g=b(".saved-formula .name"),h=0;h<a.length;h++)c[h].addEventListener("click",function(){v(this),D("saved-history",P)},!1);for(var h=0;h<a.length;h++)d[h].addEventListener("click",function(){x(this),D("saved-formulas",N)},!1);for(var h=0;h<a.length;h++)e[h].addEventListener("click",function(){x(this),D("saved-formulas",N)},!1);for(var h=0;h<a.length;h++)f[h].addEventListener("click",function(){w(this),D("saved-formulas",N),C()},!1);for(var h=0;h<a.length;h++)g[h].addEventListener("click",function(){this.select()}),g[h].addEventListener("input",function(){l(this),D("saved-formulas",N)},!1),g[h].addEventListener("keypress",j,!1)}function v(b){var c=ga(b,".saved-formula"),d=c.dataset.rollName,e=parseInt(c.dataset.ammountOfDice,10),f=parseInt(c.dataset.dice,10),g=parseInt(c.dataset.ammountOfBonus,10);a("#d"+f).checked=!0,1>=e?X.value="1":X.value=e,0==g?T.value="+0":g>0?T.value="+"+g:T.value=g,p(),n(),h(K,"dice-select"),s(e,f,g,d)}function w(b){var c=ga(b,".saved-formula"),e=c.dataset.rollName,g=parseInt(c.dataset.ammountOfDice,10),h=parseInt(c.dataset.dice,10),i=parseInt(c.dataset.ammountOfBonus,10);c.remove(),D("saved-formulas",N);var j=Date.now(),k='<div id="snack-'+j+'" class="snack-bar" data-roll-name="'+e+'" data-ammount-of-dice="'+g+'" data-dice="'+h+'" data-ammount-of-bonus="'+i+'"><div class="row"><div class="col-6"><p class="message">'+e+' removed.</p></div><div class="col-6"><a href="javascript:void(0)" class="button button-dark button-small clear"><span class="icon-close"></span></a><a href="javascript:void(0)" class="button button-dark button-small undo">Undo</a></div></div></div>';fa.innerHTML=fa.innerHTML+k;var l=a("#snack-"+j),m=function(){d(l,"reveal")};f(m,10),A();var n=function(){snackBarToClear=a("#snack-"+j),snackBarToClear&&y(snackBarToClear)};f(n,6e3),l.addEventListener("mouseover",function(){clearTimeout(f)},!1)}function x(a){var b=ga(a,".saved-formula"),c=ga(a,".list");if(a.classList.contains("move-up")){var g=b.previousSibling;d(b,"moving-up"),d(b.previousSibling,"moving-down");var h=function(){e(b.previousSibling,"moving-down"),e(b,"moving-up"),c.insertBefore(b,g),D("saved-formulas",N)};f(h,500)}else if(a.classList.contains("move-down")){var i=b.nextSibling.nextSibling;d(b.nextSibling,"moving-up"),d(b,"moving-down");var h=function(){e(b.nextSibling,"moving-up"),e(b,"moving-down"),c.insertBefore(b,i),D("saved-formulas",N)};f(h,500)}}function y(a){var b=ga(a,".snack-bar"),c=function(){e(b,"reveal")};f(c,10);var d=function(){b.remove()};f(d,500)}function z(a){var b=ga(a,".snack-bar"),c=b.dataset.rollName,d=parseInt(b.dataset.ammountOfDice,10),e=parseInt(b.dataset.dice,10),f=parseInt(b.dataset.ammountOfBonus,10);t(d,e,f,c),y(a)}function A(){for(var a=b(".snack-bar"),c=b(".snack-bar .clear"),d=b(".snack-bar .undo"),e=0;e<a.length;e++)c[e].addEventListener("click",function(){y(this)},!1);for(var e=0;e<a.length;e++)d[e].addEventListener("click",function(){z(this),D("saved-formulas",N),C()},!1)}function B(){var a=window.document,b=a.documentElement,d=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen,e=a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen;a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement?(e.call(a),c(ca,"active"),c(da,"icon-fullscreen-exit"),c(da,"icon-fullscreen")):(d.call(b),c(ca,"active"),c(da,"icon-fullscreen-exit"),c(da,"icon-fullscreen"))}function C(){P.firstChild?J.classList.add("active"):J.classList.remove("active"),Q.firstChild?Q.classList.add("active"):Q.classList.remove("active")}function D(a,b){localStorage.getItem&&localStorage.setItem(a,b.innerHTML)}function E(a,b){""==localStorage.getItem(a)?localStorage.removeItem(a):localStorage.getItem(a)&&(b.innerHTML=localStorage.getItem(a))}function F(){c(aa,"active"),c(ba,"icon-check-box"),c(ba,"icon-check-box-outline-blank");var a=aa.dataset.active;"false"==a?aa.dataset.active="true":"true"==a&&(aa.dataset.active="false")}var G,H,I,J=(a(".controls"),a(".results")),K=(a(".formulas"),a(".dice-form")),L=b(".dice-form label"),M=a(".go-roll"),N=a(".formulas .list"),O=a(".current-dice span"),P=a(".results .list"),Q=a(".saved-formulas .list"),R=a(".results .toggle-fullscreen"),S=a(".results .toggle-fullscreen span"),T=(a(".controls .number-of-bonus"),a(".controls .number-of-bonus input")),U=a(".controls .input-controls-bonus .clear"),V=a(".controls .input-controls-bonus .plus-one"),W=a(".controls .input-controls-bonus .minus-one"),X=(a(".controls .number-of-dice"),a(".controls .number-of-dice input")),Y=a(".controls .input-controls-dice .clear"),Z=a(".controls .input-controls-dice .plus-one"),$=a(".controls .input-controls-dice .minus-one"),_=a(".controls .save-current-formula"),aa=a("nav .toggle-drop-lowest"),ba=a("nav .toggle-drop-lowest span"),ca=a("nav .toggle-fullscreen"),da=a("nav .toggle-fullscreen span"),ea=a("nav .clear-all"),fa=a(".snacks"),ga=function(a,b){for(var c=b.charAt(0);a&&a!==document;a=a.parentNode){if("."===c&&a.classList.contains(b.substr(1)))return a;if("#"===c&&a.id===b.substr(1))return a;if("["===c&&a.hasAttribute(b.substr(1,b.length-2)))return a;if(a.tagName.toLowerCase()===b)return a}return!1},ha=a("nav"),ia=(a(".nav-list"),a(".nav-toggle"));ia.addEventListener("click",function(){c(ha,"open")},!1),window.addEventListener("click",function(a){ha.classList.contains("open")&&a.target!=ha&&a.target.parentNode!=ha&&a.target.parentNode.parentNode!=ha&&a.target.parentNode.parentNode.parentNode!=ha&&e(ha,"open")}),U.addEventListener("click",function(){r(0,T),p(),q()},!1),Y.addEventListener("click",function(){r(0,X),n(),o()},!1),T.addEventListener("input",function(){p()},!1),T.addEventListener("blur",function(){q()},!1),T.addEventListener("keypress",j,!1),T.addEventListener("keydown",function(){k(T),p()},!1),T.addEventListener("click",function(){this.select()},!1),V.addEventListener("click",function(){r(1,T),p(),q()},!1),W.addEventListener("click",function(){r(-1,T),p(),q()},!1),X.addEventListener("input",function(){n()},!1),X.addEventListener("blur",function(){o()},!1),X.addEventListener("keypress",j,!1),X.addEventListener("keydown",function(){k(X),n()},!1),X.addEventListener("click",function(){this.select()},!1),Z.addEventListener("click",function(){r(1,X),n(),o()},!1),$.addEventListener("click",function(){r(-1,X),n(),o()},!1),M.addEventListener("click",function(){s(n(),g(K,"dice-select"),p()),D("saved-history",P)},!1),aa.addEventListener("click",function(){F()},!1),ea.addEventListener("click",function(){m(),D("saved-history",P)},!1),_.addEventListener("click",function(){t(n(),g(K,"dice-select"),p()),D("saved-formulas",N),C()},!1),ca.addEventListener("click",function(){B()},!1),R.addEventListener("click",function(){c(J,"fullsize"),c(R,"active"),c(S,"icon-unfold-more"),c(S,"icon-unfold-less")},!1),p(),n(),i(),g(K,"dice-select"),h(K,"dice-select"),E("saved-formulas",N),E("saved-history",P),u(),C()}diceRollerama();