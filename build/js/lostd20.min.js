function diceRollerama(){function a(a){return document.querySelector(a)}function b(a){return document.querySelectorAll(a)}function c(a,b){a.classList.toggle(b)}function d(a,b){a.classList.add(b)}function e(a,b){a.classList.remove(b)}function f(a,b){window.setTimeout(a,b)}function g(a,b){for(var c=a[b],d=0;d<c.length;d++)c[d].checked&&(N=c[d].value);return N}function h(a,b){for(var c=a[b],d=0;d<c.length;d++)if(c[d].checked){S[d].classList.add("active");var e=parseInt(S[d].querySelector("input").value,10);V.textContent=e}else S[d].classList.remove("active")}function i(){for(var a=0;a<S.length;a++)S[a].addEventListener("click",function(){h(R,"dice-select")},!1)}function j(){var a=event.keyCode||event.which;13==a&&this.blur()}function k(a){var b=event.keyCode||event.which;38==b?r(1,a):40==b&&r(-1,a)}function l(a){a.setAttribute("value",a.value);var b=ma(a,".saved-formula");b.dataset.rollName=a.value}function m(){return P=parseInt(ca.value,10)||0,P>=999&&(ca.value=999,P=999),P}function n(){P=parseInt(ca.value,10)||0,(0>=P||""==P)&&(ca.value=1,P=1)}function o(){return O=parseInt($.value,10)||0,$.maxLength=3,O>=999&&($.value=999,O=999),O}function p(){O=parseInt($.value,10)||0,$.maxLength=4,0==O&&($.value="+0",O=0),O>0&&($.value="+"+O)}function q(){O=parseInt($.value,10)||0,$.value=O}function r(a,b){b.value=1*b.value+a,0==a&&(b.value="0")}function s(a,b,c,d){for(var e=[],f=0;a>f;f++)e.push(Math.floor(Math.random()*b)+1);var g,h=function(a){g=0;for(var b=0;b<a.length;b++)a[b]<a[g]&&(g=b);return g};h(e);var i,j=e.reduce(function(a,b){return a+b}),k=ha.dataset.active;"true"==k&&a>1?(i=e[g],e[g]='<span class="strike">'+e[g]+"</span>"):i=0;var l=j+c-i,m=e.join(", ");1>=a&&(a=""),0==c&&(c=""),c>0&&(c="+"+c),d||(d="");var n;n=20==b&&1>=a?20==j?" critical-20":1==j?" critical-1":"":"",W.innerHTML='<div class="result-item"><div class="row"><div class="col-xs-8"><p class="breakdown"><span class="save-roll-name">'+d+'</span> <span class="number-of-dice">'+a+'</span> <span class="dice">d'+b+'</span> <span class="number-of-bonus">'+c+'</span> <span class="multiple-dice-results">(Rolled: '+m+')</span></p></div><div class="col-xs-4"><p class="total'+n+'">'+l+"</p></div></div></div>"+W.innerHTML,A()}function t(a,b,c,d){var e=["Aieee!","Aiieee!","Arrgh!","Awk!","Awkkkkkk!","Bam!","Bang!","Bang!","Biff!","Bloop!","Blurp!","Boff!","Bonk!","Clank!","Clank!","Clash!","Clunk!","Clunk!","Crraack!","Crash!","Crraack!","Crunch!","Crunch!","Eee-yow!","Flrbbbbb!","Glipp!","Glurpp!","Kapow!","Kayo!","Ker-sploosh!","Kerplop!","Klonk!","Klunk!","Krunch!","Oooff!","Ooooff!","Ouch!","Ouch!","Owww!","Ow","Pam!","Plop!","Pow!","Powie!","Qunckkk!","Rakkk!","Rip!","Slosh!","Sock!","Splats!","Splatt!","Sploosh!","Swaap!","Swish!","Swoosh!","Thunk!","Thwack!","Thwacke!","Thwape!","Thwapp!","Uggh!","Urkkk!","Vronk!","Whack!","Whack!","Wham!","Whamm!","Whammm!","Whap!","Z-zwap!","Zam!","Zamm!","Zammm!","Zap!","Zap","Zgruppp!","Zlonk!","Zlopp!","Zlott!","Zok!","Zowie!","Zwapp!","Zzwap!","Zzzzwap!","Zzzzzwap!","Pepper-Pow!"];void 0==a&&(a=m()),void 0==b&&(b=g(R,"dice-select")),void 0==c&&(c=o()),p(),void 0==d&&(d=e[Math.floor(Math.random()*e.length)]);var f=a,h=b,i=c;1>=a&&(a=""),0==c&&(c=""),c>0&&(c="+"+c);var j=function(){U.innerHTML='<div class="saved-formula" data-roll-name="'+d+'" data-ammount-of-dice="'+f+'" data-dice="'+h+'" data-ammount-of-bonus="'+i+'"><div class="row no-gutter"><div class="col-xs-8 col-sm-5"><input type="text" placeholder="Who am I?" value="'+d+'" class="name" tabindex="4"></div><div class="col-xs-4 col-sm-3"><p class="formula"><span class="number-of-dice">'+a+'</span> <span class="dice">d'+b+'</span> <span class="number-of-bonus">'+c+'</span></p></div><div class="col-xs-2 col-sm-1"><a href="javascript:void(0)" class="button button-dark button-block clear" tabindex="4"><span class="icon-close"></span></a></div><div class="col-xs-2 col-sm-1"><a href="javascript:void(0)" class="button button-dark button-block move-up" tabindex="4"><span class="icon-expand-less"></span></a></div><div class="col-xs-2 col-sm-1"><a href="javascript:void(0)" class="button button-dark button-block move-down" tabindex="4"><span class="icon-expand-more"></span></a></div><div class="col-xs-2 col-xs-offset-4 col-sm-1 col-sm-offset-0"><a href="javascript:void(0)" class="button button-primary button-block roll" tabindex="4"><span class="icon-chevron-right"></span></a></div></div></div>'+U.innerHTML};j(),u()}function u(){for(var a=b(".saved-formula"),c=b(".saved-formula .roll"),d=b(".saved-formula .move-up"),e=b(".saved-formula .move-down"),f=b(".saved-formula .clear"),g=b(".saved-formula .name"),h=0;h<a.length;h++)c[h].addEventListener("click",function(){v(this),B("saved-history",W)},!1);for(var h=0;h<a.length;h++)d[h].addEventListener("click",function(){x(this),B("saved-formulas",U)},!1);for(var h=0;h<a.length;h++)e[h].addEventListener("click",function(){x(this),B("saved-formulas",U)},!1);for(var h=0;h<a.length;h++)f[h].addEventListener("click",function(){w(this),B("saved-formulas",U),A()},!1);for(var h=0;h<a.length;h++)g[h].addEventListener("click",function(){this.select()}),g[h].addEventListener("input",function(){l(this),B("saved-formulas",U)},!1),g[h].addEventListener("keypress",j,!1)}function v(b){var c=ma(b,".saved-formula"),d=c.dataset.rollName,e=parseInt(c.dataset.ammountOfDice,10),f=parseInt(c.dataset.dice,10),g=parseInt(c.dataset.ammountOfBonus,10);a("#d"+f).checked=!0,ca.value=e,$.value=g,p(),h(R,"dice-select"),s(e,f,g,d)}function w(a){var b=ma(a,".saved-formula"),c=b.dataset.rollName,d=parseInt(b.dataset.ammountOfDice,10),e=parseInt(b.dataset.dice,10),f=parseInt(b.dataset.ammountOfBonus,10);b.remove(),B("saved-formulas",U);Date.now();F(c+" removed.",!1,!0,d,e,f,c)}function x(a){var b=ma(a,".saved-formula"),c=ma(a,".list");if(a.classList.contains("move-up")){var g=b.previousSibling;d(b,"moving-up"),d(b.previousSibling,"moving-down");var h=function(){e(b.previousSibling,"moving-down"),e(b,"moving-up"),c.insertBefore(b,g),B("saved-formulas",U)};f(h,500)}else if(a.classList.contains("move-down")){var i=b.nextSibling.nextSibling;d(b.nextSibling,"moving-up"),d(b,"moving-down");var h=function(){e(b.nextSibling,"moving-up"),e(b,"moving-down"),c.insertBefore(b,i),B("saved-formulas",U)};f(h,500)}}function y(a){var b=a.querySelector(".text"),d=a.querySelector("span");"Expand"==b.textContent?b.textContent="Collapse":b.textContent="Expand",c(d,"icon-unfold-more"),c(d,"icon-unfold-less"),c(Q,"fullsize"),c(a,"active")}function z(){e(Q,"active"),e(Q,"fullsize"),W.innerHTML="",B("saved-history",W)}function A(){W.firstChild?Q.classList.add("active"):Q.classList.remove("active"),X.firstChild?X.classList.add("active"):X.classList.remove("active")}function B(a,b){localStorage.getItem&&localStorage.setItem(a,b.innerHTML)}function C(a,b){""==localStorage.getItem(a)?localStorage.removeItem(a):localStorage.getItem(a)&&(b.innerHTML=localStorage.getItem(a))}function D(){c(ha,"active"),c(ia,"icon-check-box-checked"),c(ia,"icon-check-box-unchecked");var a=ha.dataset.active;"false"==a?ha.dataset.active="true":"true"==a&&(ha.dataset.active="false")}function E(){var a=window.document,b=a.documentElement,d=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen,e=a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen;a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement?(e.call(a),c(ja,"active"),c(ka,"icon-fullscreen-exit"),c(ka,"icon-fullscreen")):(d.call(b),c(ja,"active"),c(ka,"icon-fullscreen-exit"),c(ka,"icon-fullscreen"))}function F(b,c,e,g,h,i,j){var k=a(".snacks"),l=document.createElement("div");l.setAttribute("class","snack-bar"),l.setAttribute("data-roll-name",j),l.setAttribute("data-ammount-of-dice",g),l.setAttribute("data-dice",h),l.setAttribute("data-ammount-of-bonus",i);var m=document.createElement("div");m.setAttribute("class","container");var n=document.createElement("div");n.setAttribute("class","row");var o=document.createElement("div");o.setAttribute("class","col-xs-10");var p=document.createElement("div");p.setAttribute("class","col-xs-2");var q=document.createElement("a");q.setAttribute("href","javascript:void(0)"),q.setAttribute("class","button button-dark button-small snack-clear");var r=document.createElement("a");r.setAttribute("href","javascript:void(0)"),r.setAttribute("class","button button-dark button-block button-small snack-undo"),r.textContent="Undo";var s=document.createElement("span");s.setAttribute("class","icon-close");var t=document.createElement("p");t.setAttribute("class","snack-message"),t.textContent=b,q.appendChild(s),e&&p.appendChild(r),c&&o.appendChild(q),o.appendChild(t),n.appendChild(o),n.appendChild(p),n.appendChild(p),m.appendChild(n),l.appendChild(m),k.appendChild(l),G(l);var u=function(){d(l,"reveal")};f(u,10);var v=function(){l&&I(l)};f(v,4e3)}function G(a){var b=ma(a,".snack-bar"),c=b.querySelector(".snack-clear"),d=b.querySelector(".snack-undo");c&&c.addEventListener("click",function(){I(this)},!1),d&&d.addEventListener("click",function(){H(this),B("saved-formulas",U),A()},!1)}function H(a){var b=ma(a,".snack-bar"),c=b.dataset.rollName,d=parseInt(b.dataset.ammountOfDice,10),e=parseInt(b.dataset.dice,10),f=parseInt(b.dataset.ammountOfBonus,10);t(d,e,f,c),I(a)}function I(a){var b=ma(a,".snack-bar"),c=function(){e(b,"reveal")};f(c,10);var d=function(){b.remove()};f(d,500)}function J(b,c,e){function g(){d(j,"reveal"),d(i,"reveal")}var h=a("body"),i=document.createElement("div");i.setAttribute("class","prompt prompt-shade");var j=document.createElement("div");j.setAttribute("class","prompt prompt-modal");var k=document.createElement("div");k.setAttribute("class","container");var l=document.createElement("div");l.setAttribute("class","row");var m=document.createElement("div");m.setAttribute("class","row");var n=document.createElement("div");n.setAttribute("class","col-xs-12");var o=document.createElement("div");o.setAttribute("class","col-xs-6 col-lg-5");var p=document.createElement("div");p.setAttribute("class","col-xs-6 col-lg-5 col-lg-offset-2");var q=document.createElement("h1");q.setAttribute("class","prompt-heading"),q.textContent=b;var r=document.createElement("p");r.setAttribute("class","prompt-message"),r.textContent=c;var s=document.createElement("a");s.setAttribute("href","javascript:void(0)"),s.setAttribute("class","button button-primary button-block prompt-action"),s.textContent="Confirm";var t=document.createElement("a");t.setAttribute("href","javascript:void(0)"),t.setAttribute("class","button button-secondary button-block prompt-cancel"),t.textContent="Cancel",n.appendChild(q),n.appendChild(r),o.appendChild(t),p.appendChild(s),l.appendChild(n),m.appendChild(o),m.appendChild(p),k.appendChild(l),k.appendChild(m),j.appendChild(k),h.querySelector(".prompt.prompt-shade")||h.querySelector(".prompt.prompt-modal")||(h.appendChild(i),h.appendChild(j),f(g,10),K(e))}function K(b){var c=a(".prompt-shade"),d=(a(".prompt-modal"),a(".prompt-modal .prompt-action")),e=a(".prompt-modal .prompt-cancel");c.addEventListener("click",function(){L()}),e.addEventListener("click",function(){L()}),d.addEventListener("click",function(){"clear all"==b&&M()})}function L(){function b(){c.remove(),d.remove()}var c=a(".prompt-shade"),d=a(".prompt-modal");a(".prompt-modal .prompt-cancel");c&&d&&(c.style.opacity=0,d.style.opacity=0,f(b,500))}function M(){localStorage.clear(),document.location.reload(!0)}var N,O,P,Q=(a(".controls"),a(".results")),R=(a(".formulas"),a(".dice-form")),S=b(".dice-form label"),T=a(".go-roll"),U=a(".formulas .list"),V=a(".current-dice span"),W=a(".results .list"),X=a(".saved-formulas .list"),Y=a(".results .toggle-fullscreen"),Z=a(".results .clear-results"),$=(a(".controls .number-of-bonus"),a(".controls .number-of-bonus input")),_=a(".controls .input-controls-bonus .clear"),aa=a(".controls .input-controls-bonus .plus-one"),ba=a(".controls .input-controls-bonus .minus-one"),ca=(a(".controls .number-of-dice"),a(".controls .number-of-dice input")),da=a(".controls .input-controls-dice .clear"),ea=a(".controls .input-controls-dice .plus-one"),fa=a(".controls .input-controls-dice .minus-one"),ga=a(".controls .save-current-formula"),ha=a("nav .toggle-drop-lowest"),ia=a("nav .toggle-drop-lowest span"),ja=a("nav .toggle-fullscreen"),ka=a("nav .toggle-fullscreen span"),la=a("nav .clear-all"),ma=function(a,b){for(var c=b.charAt(0);a&&a!==document;a=a.parentNode){if("."===c&&a.classList.contains(b.substr(1)))return a;if("#"===c&&a.id===b.substr(1))return a;if("["===c&&a.hasAttribute(b.substr(1,b.length-2)))return a;if(a.tagName.toLowerCase()===b)return a}return!1},na=a("nav"),oa=(a(".nav-list"),a(".nav-toggle"));oa.addEventListener("click",function(){c(na,"open")},!1),window.addEventListener("click",function(a){na.classList.contains("open")&&a.target!=na&&a.target.parentNode!=na&&a.target.parentNode.parentNode!=na&&a.target.parentNode.parentNode.parentNode!=na&&e(na,"open")}),_.addEventListener("click",function(){r(0,$),o(),p()},!1),da.addEventListener("click",function(){r(0,ca),m(),n()},!1),$.addEventListener("input",function(){o()},!1),$.addEventListener("blur",function(){p()},!1),$.addEventListener("focus",function(){q()},!1),$.addEventListener("keypress",j,!1),$.addEventListener("keydown",function(){k($),o()},!1),aa.addEventListener("click",function(){r(1,$),o(),p()},!1),ba.addEventListener("click",function(){r(-1,$),o(),p()},!1),ca.addEventListener("input",function(){m()},!1),ca.addEventListener("blur",function(){n()},!1),ca.addEventListener("keypress",j,!1),ca.addEventListener("keydown",function(){k(ca),m()},!1),ea.addEventListener("click",function(){r(1,ca),m(),n()},!1),fa.addEventListener("click",function(){r(-1,ca),m(),n()},!1),T.addEventListener("click",function(){s(m(),g(R,"dice-select"),o()),B("saved-history",W)},!1),ga.addEventListener("click",function(){t(m(),g(R,"dice-select"),o()),B("saved-formulas",U),A()},!1),Y.addEventListener("click",function(){y(this)},!1),Z.addEventListener("click",function(){z()},!1),ha.addEventListener("click",function(){D()},!1),ja.addEventListener("click",function(){E()},!1),la.addEventListener("click",function(){J("Are you sure?","Roll history and saved formuals will be removed. This can not be undone.","clear all")},!1),o(),m(),i(),g(R,"dice-select"),h(R,"dice-select"),C("saved-formulas",U),C("saved-history",W),u(),A(),p()}diceRollerama();